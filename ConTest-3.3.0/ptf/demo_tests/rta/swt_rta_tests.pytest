"""
 Copyright 2018 Continental Corporation

 Author:
    - M. Shan Ur Rehman <Muhammad.Shan.ur.Rehman@continental-corporation.com>

 File:
    swt_rta_tests.pytest

 Details:
    This script contains sample or demo test cases utilizing RTA (Real Time Analysis) tool.
"""


# standard library imports
import os

# PTF related imports
from ptf.ptf_utils.report import DETAILS, PRECONDITION, VERIFIES, TESTTAG, TESTSTEP, EXPECTED, TESTCASE
import rta_mts


def SWT_RTA_VERIFY_LD_BUDGETv1():
    DETAILS("Test case for checking if LD(Lane Departure) task is under budget for MFC431 project.")
    DETAILS("")
    DETAILS("For running this test cases following tools or utilities have been used:")
    DETAILS("- MTS (for running recording and running RTA MO)")
    DETAILS("- RTA MO (this (M)easurement (O)bject) will be loading in MTS")
    DETAILS("- .rrec (recording file used for MTS offline working)")
    DETAILS("")
    DETAILS("API(s) are provided to communicate with MTS-RTA tool combination.")

    PRECONDITION("Fill in precondition")

    VERIFIES("L3SW_RTA_LD")

    TESTTAG("requirement")
    TESTTAG("design_driven")
    TESTTAG("blackbox")

    TESTCASE()

    TESTSTEP("Creating an instance of RTA tool class")
    EXPECTED("Instance created successfully")
    rta_runner = rta_mts.RtaUtils()

    TESTSTEP("Setting-up input data for MTS-RTA")
    TESTSTEP("Registering RTA data for MFC431 project, LD task running on Core 14")
    EXPECTED("RTA ran on MTS successfully and created log files")
    rta_runner.run_rta(
        project="mfc431",
        recording=os.path.join("D:", os.sep, "rec", "2018.02.04_at_08.20.45_camera-mi_438.rrec"),
        meas_core_id=12,
        meas_component="SW_EVT_MARKER",
        meas_local_id="IMAGE_ODDR",
        task_core_id=14,
        task_name="LD")

    TESTSTEP("Verifying LD task ran under it's allotted budget on Core 14")
    EXPECTED("LD task ran under budget on Core 14 for MFC431 project")
    rta_runner.verify_budget()
