"""
    This file contains the (global_)setup and (global_)teardown methods.
    Copyright 2018 Continental Corporation

    This file contains up to four methods that will be called by the test framework:
        - global_setup(): Will be called before ALL testcases
        - setup(): Will be called before EACH testcase
        - teardown(): Will be called after EACH testcase. Will also be called if testcase fails.
        - global_teardown(): Will be called after ALL testcases.
                             Will be called if any execution before fails.

    :file: setup.pytest

    :author:
        - M. Shan Ur Rehman <Muhammad.Shan.ur.Rehman@continental-corporation.com>
"""



# NOTE : This file is written for RVS231 project. Others can take this as an example.

import os
from ptf.ptf_utils.global_params import *
from ptf.tools_utils.canoe import canoe

from ptf.tools_utils.arxml.arxml_reader import ArxmlReader

# change these paths if you want to run RVS demo tests using CANoe
CFG_PATH = "C:\\tools\\Cygwin\\home\\uidw6165\\sv\\projects\\rvs231\\tests\\canoe_cfg\\RVC_PTF.cfg"
DB_PATH = "C:\\tools\\Cygwin\\home\\uidw6165\\sv\\projects\\rvs231\\tests\\canoe_cfg\\" \
          "Databases\\STAR_3_RVC_HSVL_CAN_2017_42a.arxml"


def global_setup():
    """
    This method will be called before ALL testcases are executed.
    You can set global variables with :func:`set_global_parameter`.
    Will skip execution of tests if this method fails.
    """
    canoe_app = canoe.Canoe()
    arxml_read = ArxmlReader(DB_PATH)

    canoe_app.open_cfg(CFG_PATH)
    canoe_app.start_simulation()

    set_global_parameter("canoe", canoe_app)
    set_global_parameter("db", arxml_read)

def setup():
    """
    This method will be called before EACH testcase is executed.
    You can set global variables with :func:`set_global_parameter` and local variables just
    available for the next testcase using :func:`set_local_parameter`.
    Will skip execution of test if this method fails.
    Skipped if global setup fails.
    """
    pass

def teardown():
    """
    This method will be called after EACH testcase is executed.
    Guaranteed to be called, even if the test or setup fails.
    Skipped if global setup fails.
    """
    pass

def global_teardown():
    """
    This method will be called after ALL testcases are executed.
    Guaranteed to be called, even if any test or global setup fails.
    """
    canoe_app = get_parameter("canoe")
    canoe_app.close()
