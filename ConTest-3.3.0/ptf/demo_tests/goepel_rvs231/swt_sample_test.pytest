"""
    Copyright 2019 Continental Corporation

    :file: swt_sample_test.pytest
    :platform: Windows
    :synopsis:
        Sample tests for RVS231 project to grab images using video dragon II setup.

    :author:
        - Felix Wohlfrom <felix.2.wohlfrom@continental-corporation.com>
"""


# standard Python import area
import time

# ConTest or custom import area
# NOTE : ALWAYS IMPORT (contest_expects, contest_asserts, report and get_parameter) AS BELOW.
#        FOR PROPER DOCUMENTATION AND ERROR REPORTING
from contest_verify.verify import contest_asserts
from ptf.ptf_utils.report import *
from ptf.ptf_utils.global_params import get_parameter


def SWT_SAMPLE_TESTv1():
    DETAILS("Demo testcase to capture a single image from video dragon II lvds device")

    PRECONDITION("Video Dragon II properly configured. Should be done in global_setup.")

    VERIFIES("Image capturing")

    TESTTAG("hil")

    TESTSTEP("Capture an image, show it.")
    TESTSTEP("Capture another image, show it.")
    EXPECTED("Two images shown. Timestamp > 0")

    # Get lvds object
    g_lvds = get_parameter("g_lvds")

    print("Read single frame")
    img, timestamp = g_lvds.get_single_image(1920, 1080, 24, True)
    print("Timestamp: {}".format(str(timestamp)))
    contest_asserts.verify_gt(timestamp, 0, "Invalid timestamp found.")
    img.show()  # show frame

    time.sleep(0.1)

    print("Aaaand another one")
    img, timestamp = g_lvds.get_single_image(1920, 1080, 24, True)
    print("Timestamp 2: {}".format(str(timestamp)))
    contest_asserts.verify_gt(timestamp, 0, "Invalid timestamp found.")
    img.show()
