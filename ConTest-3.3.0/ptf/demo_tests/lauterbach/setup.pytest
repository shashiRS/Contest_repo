"""
    This file contains the (global_)setup and (global_)teardown methods for lauterbach tests.
    To use it running lauterbach tests, rename it to 'setup.pytest'.
    Copyright 2018 Continental Corporation

    This file contains up to four methods that will be called by the test framework:
        - global_setup(): Will be called before ALL testcases
        - setup(): Will be called before EACH testcase
        - teardown(): Will be called after EACH testcase. Will also be called if testcase fails.
        - global_teardown(): Will be called after ALL testcases.
                             Will be called if any execution before fails.

    :file: setup.pytest

    :author:
        - Felix Wohlfrom <felix.2.wohlfrom@continental-corporation.com>
"""


# NOTE : This file is written for RVS231 project. Others can take this as an example.

from ptf.ptf_utils.global_params import set_global_parameter, get_parameter
import ptf.tools_utils.lauterbach.lauterbach as lauterbach_util


def global_setup():
    # creating lauterbach object and assigning it to a global variable
    lauterbach = lauterbach_util.Lauterbach()
    set_global_parameter("t32", lauterbach)

    # change these paths in-case you have different one
    flash_cmd = '{}{} {}{} {}{} {}'.format(
        'D:\\workspace\\sv\\projects\\rvs231\\tests\\hil\\tests\\t32_flashing\\',
        'bcm989107_contiapp_flash.cmm',
        'D:\\workspace\\sv\\projects\\rvs231\\bin\\rvs231\\bcm8910x\\app\\rvs231_mlc40_0\\app\\',
        "rvs231_mlc40_0_conti_app-erika-nodebug-pt.img",
        "D:\\workspace\\sv\\projects\\rvs231\\bin\\rvs231\\bcm8910x\\app\\rvs231_mlc40_0\\app\\",
        "rvs231_mlc40_0_conti_app_erika.elf",
        'True')

    # call flash target method
    lauterbach.flash_target(flash_cmd, 300, lauterbach.TARGET_RUNNING)

def setup():
    lauterbach = get_parameter("t32")
    lauterbach.init_test_case()

def global_teardown():
    lauterbach = get_parameter("t32")
    lauterbach.close()
